<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Murder Mystery Game</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
Â  <div class="max-w-4xl mx-auto">
Â  Â  <h1 class="text-3xl font-bold text-center mb-4">ğŸ” The Blackwell Mystery</h1>

Â  Â  <section class="mb-8 bg-white p-6 rounded shadow">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-2">An Unfortunate Sequence of Events</h2>
Â  Â  Â  <p class="text-gray-700">
Â  Â  Â  Â Last night, at 7:50 PM, a wealthy man named Mr. Blackwell was found dead in the study of his large and elegant house. The police arrived quickly and immediately began asking questions to the people who were present. There were six individuals in the house at the time of the murder. Each person knew Mr. Blackwell well, and each one had a personal reason to feel angry or disappointed with him.

Bob, the gardener, had worked for Mr. Blackwell for many years. He loved the garden and cared for the plants every single day. However, last week, Mr. Blackwell decided to cut down many trees without asking for Bobâ€™s opinion. Bob felt ignored and deeply disrespected.

Frank, the musician, often played the piano during Mr. Blackwellâ€™s formal dinners and parties. He was passionate about music, but Mr. Blackwell never paid him fairly. Frank wanted to quit the job, but Mr. Blackwell refused and treated him harshly.

Alice, the cook, prepared meals for the household and cooked delicious dishes every day. But last month, Mr. Blackwell accused her of ruining a dinner that the guests did not enjoy. He shouted at her in front of everyone. Alice felt humiliated and upset.

Clara, the teacher, had been a private tutor for Mr. Blackwellâ€™s children many years ago. Recently, Mr. Blackwell told her that he planned to dismiss her because he no longer â€œneededâ€ her. Clara felt used, unappreciated, and easily replaceable.

Eva, the family doctor, visited the house frequently because Mr. Blackwell had several health problems. Last month, he refused to follow her medical instructions and blamed her for his continued pain, humiliating her publicly. Eva left the house feeling exhausted and frustrated.

Gina, the librarian, organized and protected Mr. Blackwellâ€™s private book collection. She loved books deeply and took pride in her work. But when Mr. Blackwell announced that he wanted to sell some of the rare books, Gina strongly disagreed. She felt that he didnâ€™t respect knowledge or culture.

Although everyone appeared calm, there was clear tension in the air. Each person had a reason to hate Mr. Blackwell. Now, the police must discover who is telling the truthâ€¦ and who is hiding something.

The mystery begins.

Â  Â  Â  </p>
Â  Â  </section>

Â  Â  <section class="mb-8">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Suspects</h2>
Â  Â  Â  <div class="grid grid-cols-2 md:grid-cols-3 gap-4" id="suspect-grid"></div>
Â  Â  </section>

Â  Â  <div id="question-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
Â  Â  Â  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
Â  Â  Â  Â  <h3 class="text-xl font-bold mb-4" id="modal-title">Ask a Question</h3>
Â  Â  Â  Â  <ul id="modal-word-bank" class="flex gap-2 flex-wrap p-4 bg-gray-100 rounded mb-4 min-h-[60px]"></ul>
Â  Â  Â  Â  <button onclick="checkModalQuestion()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Check</button>
Â  Â  Â  Â  <p id="modal-result" class="mt-2 font-bold"></p>
Â  Â  Â  Â  <button id="next-question-btn" onclick="nextModalQuestion()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hidden">Next</button>
Â  Â  Â  Â  <button onclick="closeModal()" class="mt-4 text-sm text-red-500 underline">Close</button>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <section class="mb-8">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Killer's Timeline</h2>
Â  Â  Â  <p class="mb-2 text-gray-600">Write what happened between 7:40 and 7:50:</p>
Â  Â  Â  <form id="timeline-form" class="bg-white rounded-lg shadow p-4 space-y-4">
Â  Â  Â  Â  <div><label class="block font-semibold">7:40 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time1"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:45 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time2"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:47 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time3"></div>
Â  Â  Â  Â  <div><label class="block font-semibold">7:50 PM</label><input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="What happened?" id="time4"></div>
Â  Â  Â  Â  <button type="button" onclick="checkTimeline()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Check</button>
Â  Â  Â  Â  <p id="timeline-result" class="mt-2 font-bold"></p>
Â  Â  Â  </form>
Â  Â  </section>

Â  Â  <section>
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">Who Did It?</h2>
Â  Â  Â  <p class="text-gray-600 mb-2">Choose the killer:</p>
Â  Â  Â  <select id="killer-guess" class="w-full max-w-xs p-2 border border-gray-300 rounded">
Â  Â  Â  Â  <option value="">-- Choose --</option>
Â  Â  Â  Â  <option>Alice</option>
Â  Â  Â  Â  <option>Bob</option>
Â  Â  Â  Â  <option>Clara</option>
Â  Â  Â  Â  <option>Eva</option>
Â  Â  Â  Â  <option>Frank</option>
Â  Â  Â  Â  <option>Gina</option>
Â  Â  Â  </select>
Â  Â  Â  <button onclick="checkKillerGuess()" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Submit</button>
Â  Â  Â  <p id="killer-result" class="mt-2 font-bold"></p>
Â  Â  </section>
Â  </div>

Â  <script>
    // Variable global para almacenar la instancia de Sortable.js
    let currentSortable = null;
    
Â  Â  const suspects = [
Â  Â  Â  {
Â  Â  Â  Â  name: 'Alice',
Â  Â  Â  Â  job: 'Cook',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At that precise moment, I was preparing the evening meal in the kitchen. I was quite busy cutting vegetables.',
Â  Â  Â  Â  Â  q2: 'Around 7:45, I saw someone running down the corridor towards the study. I couldn\'t distinguish their face because of the distance.',
Â  Â  Â  Â  Â  q3: 'I was shocked when the lights suddenly went off. Then, a faint but distinct scream was heard from the study\'s direction.',
Â  Â  Â  Â  Â  q4: 'I stayed in the kitchen, feeling a bit anxious. I was waiting for the lights to be turned back on before leaving.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Bob',
Â  Â  Â  Â  job: 'Gardener',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'At that time, I had stepped out to the garden. I usually check the watering system around that time every day, so I was busy outside.',
Â  Â  Â  Â  Â  q2: 'No one was visible from my perspective, but I certainly heard a loud noise that seemed to come from inside the mansion.',
Â  Â  Â  Â  Â  q3: 'I was just finishing up when the house lights went completely dark. It was then that a loud scream made me drop my tools.',
Â  Â  Â  Â  Â  q4: 'Immediately after the incident, I made my way back into the house, but Eva reached the study before me.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Clara',
Â  Â  Â  Â  job: 'Teacher',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'I was in the main living room, trying to finish a chapter of a novel. I always read Gina\'s recommendations.',
Â  Â  Â  Â  Â  q2: 'At that time, I remember going outside to see if Bob was there, which he was. We talked about the unusual weather we were having.',
Â  Â  Â  Â  Â  q3: 'The sudden darkness was frightening. I was definitely scared by the noise and the following scream; it was terrifying.',
Â  Â  Â  Â  Â  q4: 'I decided it was safer to go back to my room and lock the door.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Eva',
Â  Â  Â  Â  job: 'Doctor',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'I was busy writing a medical journal in the main hall. I always take a few minutes for reading before dinner.',
Â  Â  Â  Â  Â  q2: 'Yes, I noticed Alice in the kitchen area. She was definitely cooking and seemed focused on her task. I didn\'t see anyone else.',
Â  Â  Â  Â  Â  q3: 'The abrupt darkness, followed by the sound of a scream coming from the study, made my heart pound. I had to investigate.',
Â  Â  Â  Â  Â  q4: 'As soon as the lights returned, I rushed to the study. It was me who discovered Mr. Blackwell\'s body and called for assistance immediately.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Frank',
Â  Â  Â  Â  job: 'Musician',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'I was practicing a difficult piece in the music room. The soundproofing in there is excellent for playing the electric guitar.',
Â  Â  Â  Â  Â  q2: 'I looked through the window for a moment and clearly saw Bob in the garden, working with some tools by himself.',
Â  Â  Â  Â  Â  q3: 'The sudden darkness interrupted my practice, but I couldn\'t hear anything because of the soundproofed walls.',
Â  Â  Â  Â  Â  q4: 'I stayed alone in the music room. I figured it wasn\'t my obligation to go check what was going on.'
Â  Â  Â  Â  }
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  name: 'Gina',
Â  Â  Â  Â  job: 'Librarian',
Â  Â  Â  Â  responses: {
Â  Â  Â  Â  Â  q1: 'I was organizing the new acquisitions in the library. It\'s quite a lonely job, but I enjoy it.',
Â  Â  Â  Â  Â  q2: 'I saw Clara. She was standing near the study room entrance, but I think she quickly moved towards the living room. I\'m not too sure.',
Â  Â  Â  Â  Â  q3: 'After the lights went off, I heard a terrible, high-pitched scream.',
Â  Â  Â  Â  Â  q4: 'I decided to stay in the library, as the books are extremely valuable and must be protected at all times.'
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  ];

    // Preguntas avanzadas: Past Continuous, Conditional, Modals, Passive, etc.
Â  Â  const allQuestions = [
Â  Â  Â  'What were you doing at 7:40?', 
Â  Â  Â  'Did you see anything at 7:45?', 
Â  Â  Â  'What happened at 7:47?', 
Â  Â  Â  'What did you do at 7:50?' 
Â  Â  ];

Â  Â  let currentSuspect = null;
Â  Â  let currentQuestionIndex = 0;

Â  Â  const suspectGrid = document.getElementById('suspect-grid');
Â  Â  suspects.forEach((s) => {
Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  div.className = 'bg-white p-4 rounded shadow text-center cursor-pointer hover:bg-blue-100';
Â  Â  Â  div.onclick = () => openModal(s);
Â  Â  Â  div.innerHTML = `<h3 class='font-bold text-lg'>${s.name}</h3><p class='text-sm text-gray-600'>${s.job}</p>`;
Â  Â  Â  suspectGrid.appendChild(div);
Â  Â  });

Â  Â  function openModal(suspect) {
Â  Â  Â  currentSuspect = suspect;
Â  Â  Â  currentQuestionIndex = 0;
Â  Â  Â  document.getElementById('modal-result').textContent = '';
Â  Â  Â  loadModalQuestion();
Â  Â  Â  document.getElementById('question-modal').classList.remove('hidden');
Â  Â  }

Â  Â  function loadModalQuestion() {
Â  Â  Â  document.getElementById('modal-title').textContent = `Ask ${currentSuspect.name}`;
Â  Â  Â  const bank = document.getElementById('modal-word-bank');
Â  Â  Â  bank.innerHTML = '';
Â  Â  Â  document.getElementById('next-question-btn').classList.add('hidden');

      // 1. DESTRUYE la instancia anterior de Sortable si existe.
      if (currentSortable) {
          currentSortable.destroy();
          currentSortable = null; 
      }

Â  Â  Â  // Separamos el signo de interrogaciÃ³n de la Ãºltima palabra para que sea un bloque individual
Â  Â  Â  const questionWithoutPunctuation = allQuestions[currentQuestionIndex].slice(0, -1);
Â  Â  Â  let selectedWords = questionWithoutPunctuation.split(' ');
Â  Â  Â  selectedWords.push('?'); // Agregamos el signo de interrogaciÃ³n como una palabra/bloque mÃ¡s

Â  Â  Â  shuffle(selectedWords);
Â  Â  Â  selectedWords.forEach(word => {
Â  Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  Â  li.textContent = word;
Â  Â  Â  Â  li.className = 'px-3 py-2 bg-blue-100 rounded cursor-move';
Â  Â  Â  Â  bank.appendChild(li);
Â  Â  Â  });
      
      // 2. CREA la nueva instancia de Sortable y guÃ¡rdala.
Â  Â  Â  currentSortable = Sortable.create(bank, { animation: 150 });
Â  Â  }

Â  Â  function checkModalQuestion() {
Â  Â  Â  const words = [...document.getElementById('modal-word-bank').children].map(li => li.textContent);
Â  Â  Â  
Â  Â  Â  // Unimos las palabras y luego reemplazamos " ?" por "?" para corregir el formato.
Â  Â  Â  let userQuestion = words.join(' ');
Â  Â  Â  userQuestion = userQuestion.replace(' ?', '?').trim(); 

Â  Â  Â  const expected = allQuestions[currentQuestionIndex].trim();
Â  Â  Â  const result = document.getElementById('modal-result');

Â  Â  Â  if (userQuestion === expected) { 
Â  Â  Â  Â  const answer = currentSuspect.responses[`q${currentQuestionIndex + 1}`];
Â  Â  Â  Â  result.textContent = `${currentSuspect.name} said: \"${answer}\"`;
Â  Â  Â  Â  document.getElementById('next-question-btn').classList.remove('hidden');
Â  Â  Â  } else {
Â  Â  Â  Â  result.textContent = 'âŒ Try again. Check your grammar and word order!';
Â  Â  Â  }
Â  Â  }


Â  Â  function nextModalQuestion() {
Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  if (currentQuestionIndex >= allQuestions.length) {
Â  Â  Â  Â  closeModal();
Â  Â  Â  } else {
Â  Â  Â  Â  document.getElementById('modal-result').textContent = '';
Â  Â  Â  Â  loadModalQuestion();
Â  Â  Â  }
Â  Â  }

Â  Â  function closeModal() {
Â  Â  Â  document.getElementById('question-modal').classList.add('hidden');
      // Destruye la instancia al cerrar el modal tambiÃ©n
      if (currentSortable) {
          currentSortable.destroy();
          currentSortable = null;
      }
Â  Â  }

Â  Â  function checkTimeline() {
Â  Â  Â  // Oraciones correctas - La verdad detrÃ¡s de la mentira de Clara y las coartadas de los demÃ¡s.
Â  Â  Â  const expected = [
Â  Â  Â  Â  'Clara was in the main living room, reading a book.', 
Â  Â  Â  Â  'Clara ran towards the study.', 
Â  Â  Â  Â  'Clara turned off the lights and killed Mr. Blackwell.', 
Â  Â  Â  Â  'Eva found the body in the study.'
Â  Â  Â  ];

Â  Â  Â  // Solo 4 entradas de tiempo (7:40, 7:45, 7:47, 7:50)
Â  Â  Â  const userAnswers = [
Â  Â  Â  Â  document.getElementById('time1').value.trim(),
Â  Â  Â  Â  document.getElementById('time2').value.trim(),
Â  Â  Â  Â  document.getElementById('time3').value.trim(),
Â  Â  Â  Â  document.getElementById('time4').value.trim()
Â  Â  Â  ];

Â  Â  Â  const result = document.getElementById('timeline-result');
Â  Â  Â  // Comprueba que la longitud de las respuestas sea la misma y que todas sean correctas
Â  Â  Â  const isCorrect = userAnswers.length === expected.length && userAnswers.every((ans, i) => ans.toLowerCase() === expected[i].toLowerCase());

Â  Â  Â  result.textContent = isCorrect ? 'âœ… Correct timeline!' : 'âŒ Try again.';
Â  Â  }

Â  Â  function checkKillerGuess() {
Â  Â  Â  const guess = document.getElementById('killer-guess').value;
Â  Â  Â  const result = document.getElementById('killer-result');
Â  Â  Â  result.textContent = guess === 'Clara' ? `âœ… Correct! ${guess} is the killer.` : `âŒ No, ${guess} is not the killer.`;
Â  Â  }

Â  Â  function shuffle(arr) {
Â  Â  Â  for (let i = arr.length - 1; i > 0; i--) {
Â  Â  Â  Â  const j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  [arr[i], arr[j]] = [arr[j], arr[i]];
Â  Â  Â  }
Â  Â  }
Â  </script>
</body>
</html>
